<tr><td>&nbsp;</td></tr>
<% (synth.min_note..synth.max_note).to_a.reverse.each_with_index do |note, index| %>
  <tr class='overview_melody' title="<%= display_midi_note(note) %>">
    <% if index == 0 %>
      <th rowspan="<%= synth.range %>" valign=top>
        <%= synth.name %>
      </th>
  <% end %>
    <% synth.step_count.times do |step| %>
      <%# TODO helper to get class for synth, note and step %>
      <% kls = (step % 4 == 0) ? 'marker ' : '' %>
      <% if synth.pitch_at_step(step) == note
           if synth.patterns.note_on.pattern_indexes.include?(step)
             kls << 'note_start'
           elsif synth.active_at_step(step)
             kls << 'note_continues'
           else
             kls << 'inactive'
           end
         else
           kls << 'inactive'
         end %>
      <td class="step <%= kls %>"
          id="<%= synth.name %>_note_<%= note %>_step_<%= step %>">
        <div></div>
      </td>
    <% end %>
  </tr>
<% end %>
